[phases.setup]
# Use Python from Nix. Don't add "pip" as a nix package (it breaks builds).
nixPkgs = ["python311"]

[phases.install]
cmds = [
  # Some Nix Python builds don't ship the `pip` executable wrapper; ensure it exists.
  "python -m ensurepip --upgrade",
  "python -m pip install --upgrade pip",
  "python -m pip install -r requirements.txt"
]

[phases.build]
cmds = [
  "mkdir -p data",
  "mkdir -p logs"
]

[start]
cmd = "python run_unified.py"
